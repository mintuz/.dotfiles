

var AtomInput = require('../../../ui/atom-input');

/*
 * Copyright (c) 2015-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the license found in the LICENSE file in
 * the root directory of this source tree.
 */

var _require = require('react-for-atom');

var React = _require.React;
var PropTypes = React.PropTypes;

var FilePreview = React.createClass({
  displayName: 'FilePreview',

  propTypes: {
    text: PropTypes.string.isRequired,
    grammar: PropTypes.object,
    references: PropTypes.arrayOf(PropTypes.object /*Reference*/).isRequired,
    startLine: PropTypes.number.isRequired,
    endLine: PropTypes.number.isRequired
  },

  componentDidMount: function componentDidMount() {
    var editor = this.refs.editor.getTextEditor();
    var _props = this.props;
    var grammar = _props.grammar;
    var references = _props.references;
    var startLine = _props.startLine;
    var endLine = _props.endLine;

    if (grammar) {
      editor.setGrammar(grammar);
    }

    references.forEach(function (ref) {
      var marker = editor.markBufferRange([[ref.start.line - startLine, ref.start.column - 1], [ref.end.line - startLine, ref.end.column]]);
      editor.decorateMarker(marker, { type: 'highlight', 'class': 'reference' });
    });

    // Make sure at least one highlight is visible.
    editor.scrollToBufferPosition([references[0].end.line - startLine, references[0].end.column - 1]);
  },

  render: function render() {
    var lineNumbers = [];
    for (var i = this.props.startLine; i <= this.props.endLine; i++) {
      lineNumbers.push(React.createElement(
        'div',
        { key: i, className: 'nuclide-find-references-line-number' },
        i
      ));
    }
    return React.createElement(
      'div',
      { className: 'nuclide-find-references-file-preview' },
      React.createElement(
        'div',
        { className: 'nuclide-find-references-line-number-column' },
        lineNumbers
      ),
      React.createElement(AtomInput, {
        ref: 'editor',
        initialValue: this.props.text,
        disabled: true
      })
    );
  }

});

module.exports = FilePreview;
//# sourceMappingURL=data:application/json;base64,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QUcsV0FBVyxDQUFDIiwiZmlsZSI6IkZpbGVQcmV2aWV3LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuaW1wb3J0IHR5cGUge1JlZmVyZW5jZX0gZnJvbSAnLi4vdHlwZXMnO1xuXG5jb25zdCBBdG9tSW5wdXQgPSByZXF1aXJlKCcuLi8uLi8uLi91aS9hdG9tLWlucHV0Jyk7XG5jb25zdCB7UmVhY3R9ID0gcmVxdWlyZSgncmVhY3QtZm9yLWF0b20nKTtcbmNvbnN0IHtQcm9wVHlwZXN9ID0gUmVhY3Q7XG5cbmNvbnN0IEZpbGVQcmV2aWV3ID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXG4gIHByb3BUeXBlczoge1xuICAgIHRleHQ6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICBncmFtbWFyOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIHJlZmVyZW5jZXM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5vYmplY3QgLypSZWZlcmVuY2UqLykuaXNSZXF1aXJlZCxcbiAgICBzdGFydExpbmU6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgICBlbmRMaW5lOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gIH0sXG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgY29uc3QgZWRpdG9yID0gdGhpcy5yZWZzLmVkaXRvci5nZXRUZXh0RWRpdG9yKCk7XG4gICAgY29uc3Qge2dyYW1tYXIsIHJlZmVyZW5jZXMsIHN0YXJ0TGluZSwgZW5kTGluZX0gPSB0aGlzLnByb3BzO1xuXG4gICAgaWYgKGdyYW1tYXIpIHtcbiAgICAgIGVkaXRvci5zZXRHcmFtbWFyKGdyYW1tYXIpO1xuICAgIH1cblxuICAgIHJlZmVyZW5jZXMuZm9yRWFjaCgocmVmOiBSZWZlcmVuY2UpID0+IHtcbiAgICAgIGNvbnN0IG1hcmtlciA9IGVkaXRvci5tYXJrQnVmZmVyUmFuZ2UoW1xuICAgICAgICBbcmVmLnN0YXJ0LmxpbmUgLSBzdGFydExpbmUsIHJlZi5zdGFydC5jb2x1bW4gLSAxXSxcbiAgICAgICAgW3JlZi5lbmQubGluZSAtIHN0YXJ0TGluZSwgcmVmLmVuZC5jb2x1bW5dLFxuICAgICAgXSk7XG4gICAgICBlZGl0b3IuZGVjb3JhdGVNYXJrZXIobWFya2VyLCB7dHlwZTogJ2hpZ2hsaWdodCcsIGNsYXNzOiAncmVmZXJlbmNlJ30pO1xuICAgIH0pO1xuXG4gICAgLy8gTWFrZSBzdXJlIGF0IGxlYXN0IG9uZSBoaWdobGlnaHQgaXMgdmlzaWJsZS5cbiAgICBlZGl0b3Iuc2Nyb2xsVG9CdWZmZXJQb3NpdGlvbihbXG4gICAgICByZWZlcmVuY2VzWzBdLmVuZC5saW5lIC0gc3RhcnRMaW5lLFxuICAgICAgcmVmZXJlbmNlc1swXS5lbmQuY29sdW1uIC0gMSxcbiAgICBdKTtcbiAgfSxcblxuICByZW5kZXIoKTogUmVhY3RFbGVtZW50IHtcbiAgICBjb25zdCBsaW5lTnVtYmVycyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSB0aGlzLnByb3BzLnN0YXJ0TGluZTsgaSA8PSB0aGlzLnByb3BzLmVuZExpbmU7IGkrKykge1xuICAgICAgbGluZU51bWJlcnMucHVzaChcbiAgICAgICAgPGRpdiBrZXk9e2l9IGNsYXNzTmFtZT1cIm51Y2xpZGUtZmluZC1yZWZlcmVuY2VzLWxpbmUtbnVtYmVyXCI+XG4gICAgICAgICAge2l9XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwibnVjbGlkZS1maW5kLXJlZmVyZW5jZXMtZmlsZS1wcmV2aWV3XCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibnVjbGlkZS1maW5kLXJlZmVyZW5jZXMtbGluZS1udW1iZXItY29sdW1uXCI+XG4gICAgICAgICAge2xpbmVOdW1iZXJzfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPEF0b21JbnB1dFxuICAgICAgICAgIHJlZj1cImVkaXRvclwiXG4gICAgICAgICAgaW5pdGlhbFZhbHVlPXt0aGlzLnByb3BzLnRleHR9XG4gICAgICAgICAgZGlzYWJsZWQ9e3RydWV9XG4gICAgICAgIC8+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBGaWxlUHJldmlldztcbiJdfQ==